{% extends "base.html" %}

{% block title %}Subnet Scanner â€” Ping Sweep{% endblock %}

{% block content %}
<!-- Content Header -->
<div class="content-header">
    <div class="container-fluid">
        <div class="row mb-2 align-items-center">
            <div class="col-sm-6">
                <h1 class="m-0 page-title">
                    <i class="fas fa-satellite-dish mr-2"></i>Ping Sweep
                </h1>
            </div>
            <div class="col-sm-6">
                <ol class="breadcrumb float-sm-right">
                    <li class="breadcrumb-item"><a href="/">Home</a></li>
                    <li class="breadcrumb-item active">Ping Sweep</li>
                </ol>
            </div>
        </div>
    </div>
</div>

<!-- Main Content -->
<section class="content">
    <div class="container-fluid">

        <!-- Scan Controls -->
        <div class="card card-scan-controls">
            <div class="card-body">
                <form id="scanForm" class="scan-form">
                    <div class="row align-items-end">
                        <div class="col-lg-5 col-md-6">
                            <div class="form-group mb-lg-0">
                                <label class="form-label">
                                    <i class="fas fa-network-wired mr-1"></i> Target Subnet
                                </label>
                                <div class="input-group input-group-lg">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            <i class="fas fa-search"></i>
                                        </span>
                                    </div>
                                    <input type="text" 
                                           class="form-control" 
                                           id="subnetInput" 
                                           placeholder="e.g. 192.168.1.0/24" 
                                           autocomplete="off"
                                           spellcheck="false">
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3">
                            <div class="form-group mb-lg-0">
                                <label class="form-label">Quick Presets</label>
                                <select class="form-control form-control-lg" id="presetSelect">
                                    <option value="">Custom</option>
                                    <option value="192.168.1.0/24">192.168.1.0/24</option>
                                    <option value="192.168.0.0/24">192.168.0.0/24</option>
                                    <option value="10.0.0.0/24">10.0.0.0/24</option>
                                    <option value="172.16.0.0/24">172.16.0.0/24</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-3">
                            <div class="btn-group btn-group-lg w-100" role="group">
                                <button type="submit" class="btn btn-primary btn-scan" id="btnScan">
                                    <i class="fas fa-play mr-2"></i>Start Scan
                                </button>
                                <button type="button" class="btn btn-danger btn-stop d-none" id="btnStop">
                                    <i class="fas fa-stop mr-2"></i>Stop
                                </button>
                                <button type="button" class="btn btn-secondary" id="btnClear" title="Clear results">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <!-- Stats Cards -->
        <div class="row stats-row">
            <div class="col-lg-3 col-6">
                <div class="small-box bg-gradient-dark stat-box">
                    <div class="inner">
                        <h3 id="statTotal">0</h3>
                        <p>Total Hosts</p>
                    </div>
                    <div class="icon"><i class="fas fa-server"></i></div>
                </div>
            </div>
            <div class="col-lg-3 col-6">
                <div class="small-box stat-box stat-box-online">
                    <div class="inner">
                        <h3 id="statOnline">0</h3>
                        <p>Online</p>
                    </div>
                    <div class="icon"><i class="fas fa-check-circle"></i></div>
                </div>
            </div>
            <div class="col-lg-3 col-6">
                <div class="small-box stat-box stat-box-offline">
                    <div class="inner">
                        <h3 id="statOffline">0</h3>
                        <p>Offline</p>
                    </div>
                    <div class="icon"><i class="fas fa-times-circle"></i></div>
                </div>
            </div>
            <div class="col-lg-3 col-6">
                <div class="small-box bg-gradient-dark stat-box">
                    <div class="inner">
                        <h3 id="statProgress">0<sup style="font-size:20px">%</sup></h3>
                        <p>Progress</p>
                    </div>
                    <div class="icon"><i class="fas fa-tasks"></i></div>
                    <div class="progress-bar-bottom">
                        <div class="progress-fill" id="progressFill" style="width:0%"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- View Toggle -->
        <div class="view-toggle-bar">
            <div class="btn-group btn-group-toggle" data-toggle="buttons">
                <label class="btn btn-outline-light active" id="btnGridView">
                    <input type="radio" name="viewMode" value="grid" checked>
                    <i class="fas fa-th mr-1"></i> Grid View
                </label>
                <label class="btn btn-outline-light" id="btnListView">
                    <input type="radio" name="viewMode" value="list">
                    <i class="fas fa-list mr-1"></i> List View
                </label>
            </div>
            <div class="view-filters">
                <div class="btn-group" role="group">
                    <button class="btn btn-sm btn-outline-light filter-btn active" data-filter="all">All</button>
                    <button class="btn btn-sm btn-outline-success filter-btn" data-filter="online">Online</button>
                    <button class="btn btn-sm btn-outline-danger filter-btn" data-filter="offline">Offline</button>
                </div>
            </div>
        </div>

        <!-- Grid View -->
        <div class="card card-results" id="gridViewCard">
            <div class="card-body">
                <div class="ip-grid" id="ipGrid">
                    <div class="empty-state" id="emptyState">
                        <div class="empty-icon">
                            <i class="fas fa-satellite-dish"></i>
                        </div>
                        <h4>Ready to Scan</h4>
                        <p>Enter a subnet in CIDR notation and hit <strong>Start Scan</strong> to discover hosts on your network.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- List View -->
        <div class="card card-results d-none" id="listViewCard">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-dark table-striped table-hover mb-0" id="resultsTable">
                        <thead>
                            <tr>
                                <th>Status</th>
                                <th>IP Address</th>
                                <th>Hostname</th>
                                <th>Response Time</th>
                                <th>Open Ports</th>
                                <th>OS</th>
                                <th>MAC Address</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="resultsTableBody">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </div>
</section>

<!-- Host Detail Modal -->
<div class="modal fade" id="hostDetailModal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-xl modal-dialog-scrollable" role="document">
        <div class="modal-content bg-dark">
            <div class="modal-header border-secondary">
                <h5 class="modal-title" id="hostDetailTitle">
                    <i class="fas fa-info-circle mr-2"></i>Host Details
                </h5>
                <button type="button" class="close text-white" data-dismiss="modal">
                    <span>&times;</span>
                </button>
            </div>
            <div class="modal-body" id="hostDetailBody">
                <div class="text-center py-5">
                    <div class="spinner-border text-primary" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                    <p class="mt-3 text-muted">Scanning host...</p>
                </div>
            </div>
            <div class="modal-footer border-secondary">
                <button type="button" class="btn btn-outline-info" id="btnFullScan">
                    <i class="fas fa-search-plus mr-1"></i>Full Nmap Scan
                </button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/scanner.js') }}"></script>
{% endblock %}
