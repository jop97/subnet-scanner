<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Subnet Scanner{% endblock %}</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Bootstrap 4 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">

    <!-- DataTables Bootstrap 4 -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap4.min.css">

    <!-- Custom Theme -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/custom.css') }}?v=25">

    {% block extra_css %}{% endblock %}
</head>
<body>

    <!-- ── Navbar ──────────────────────────────────────────────────────── -->
    <nav class="top-nav">
        <a class="nav-brand" href="/">
            <span class="brand-icon"><i class="fas fa-network-wired"></i></span>
            <span class="brand-name">SubnetScanner</span>
            <span class="brand-tag">v1.2.0</span>
        </a>
        <div class="nav-actions">
            <span class="nav-conn">
                <span class="conn-dot" id="connectionDot"></span>
                <span class="conn-label" id="connectionText">Disconnected</span>
            </span>
            <button class="nav-btn" data-toggle="modal" data-target="#settingsModal" title="Settings">
                <i class="fas fa-cog"></i>
            </button>
            <button class="nav-btn" id="btnFullscreen" title="Fullscreen">
                <i class="fas fa-expand"></i>
            </button>
        </div>
    </nav>

    <!-- ── Main Content ────────────────────────────────────────────────── -->
    <main class="app-main">
        {% block content %}{% endblock %}
    </main>

    <!-- ── Footer ──────────────────────────────────────────────────────── -->
    <footer class="app-footer">
        <span>&copy; 2026 Subnet Scanner v1.2.0</span>
        <span>Flask &middot; Nmap &middot; Socket.IO &middot; Deep Scan &middot; WHOIS</span>
    </footer>

    <!-- ── Settings Modal ──────────────────────────────────────────────── -->
    <div class="modal fade" id="settingsModal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-cog mr-2"></i>Settings</h5>
                    <button type="button" class="modal-close" data-dismiss="modal" aria-label="Close">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">

                    <!-- Scan Profile -->
                    <div class="settings-section">
                        <h6 class="settings-heading"><i class="fas fa-tachometer-alt mr-2"></i>Scan Profile</h6>
                        <div class="profile-selector">
                            <button type="button" class="profile-btn" data-profile="fast" title="500ms timeout, 1 ping, top 20 ports">
                                <i class="fas fa-bolt"></i>
                                <span>Fast</span>
                            </button>
                            <button type="button" class="profile-btn active" data-profile="normal" title="1000ms timeout, 1 ping, balanced">
                                <i class="fas fa-balance-scale"></i>
                                <span>Normal</span>
                            </button>
                            <button type="button" class="profile-btn" data-profile="thorough" title="2000ms timeout, 2 pings, more ports">
                                <i class="fas fa-microscope"></i>
                                <span>Thorough</span>
                            </button>
                        </div>
                        <small class="text-muted d-block mt-2" id="profileDescription">Balanced speed and coverage for typical networks.</small>
                    </div>

                    <!-- Quick Sweep -->
                    <div class="settings-section">
                        <h6 class="settings-heading"><i class="fas fa-satellite-dish mr-2"></i>Quick Sweep</h6>
                        <div class="setting-row">
                            <label for="settingTimeout">Ping Timeout (ms)</label>
                            <input type="number" class="form-input sm" id="settingTimeout" value="1000" min="100" max="10000" step="100">
                            <small>Max wait time per host ping</small>
                        </div>
                        <div class="setting-row">
                            <label for="settingThreads">Concurrent Threads</label>
                            <input type="number" class="form-input sm" id="settingThreads" value="50" min="1" max="500">
                            <small>Number of parallel ping threads</small>
                        </div>
                        <div class="setting-row">
                            <label for="settingSweepPingCount">Pings per Host</label>
                            <input type="number" class="form-input sm" id="settingSweepPingCount" value="1" min="1" max="5" step="1">
                            <small>Number of ICMP pings during sweep (1 = fastest)</small>
                        </div>
                    </div>

                    <!-- Full Scan (Table) -->
                    <div class="settings-section">
                        <h6 class="settings-heading"><i class="fas fa-table mr-2"></i>Full Scan (Table)</h6>
                        <small class="text-muted d-block mb-2">Settings for batch scanning all online hosts to populate the table.</small>
                        <div class="setting-row">
                            <label for="settingNmapTopPorts">Top Ports per Host</label>
                            <select class="form-input sm" id="settingNmapTopPorts">
                                <option value="20" selected>20 (fast)</option>
                                <option value="100">100</option>
                                <option value="500">500</option>
                                <option value="1000">1000 (thorough)</option>
                            </select>
                            <small>More ports = slower but more complete</small>
                        </div>
                        <div class="setting-row">
                            <label for="settingNmapTiming">Nmap Timing</label>
                            <select class="form-input sm" id="settingNmapTiming">
                                <option value="T3">T3 (Polite)</option>
                                <option value="T4" selected>T4 (Aggressive)</option>
                                <option value="T5">T5 (Insane)</option>
                            </select>
                            <small>Higher = faster but may miss ports</small>
                        </div>
                    </div>

                    <!-- Detail Modal -->
                    <div class="settings-section">
                        <h6 class="settings-heading"><i class="fas fa-info-circle mr-2"></i>Detail Modal</h6>
                        <small class="text-muted d-block mb-2">Settings for the in-depth scan when opening a host's detail view.</small>
                        <div class="setting-row">
                            <label for="settingDetailTopPorts">Top Ports</label>
                            <select class="form-input sm" id="settingDetailTopPorts">
                                <option value="1000">1000</option>
                                <option value="2500" selected>2500 (recommended)</option>
                                <option value="5000">5000</option>
                                <option value="10000">10000 (slow)</option>
                            </select>
                            <small>Number of top ports for the detail scan</small>
                        </div>
                        <div class="setting-row">
                            <label for="settingDetailTimeout">Host Timeout (s)</label>
                            <input type="number" class="form-input sm" id="settingDetailTimeout" value="180" min="60" max="600" step="30">
                            <small>Max time for nmap to scan a single host</small>
                        </div>
                    </div>

                    <!-- Deep Probes -->
                    <div class="settings-section">
                        <h6 class="settings-heading"><i class="fas fa-flask mr-2"></i>Deep Probes</h6>
                        <small class="text-muted d-block mb-2">Additional probes run after nmap (HTTP, SSL, banners, etc.)</small>
                        <div class="setting-row">
                            <label for="settingDeepTimeout">Probe Timeout (s)</label>
                            <input type="number" class="form-input sm" id="settingDeepTimeout" value="5" min="1" max="30" step="1">
                            <small>Timeout per probe (HTTP, SSL, banner)</small>
                        </div>
                        <div class="setting-row">
                            <label for="settingSsdpTimeout">SSDP Timeout (s)</label>
                            <input type="number" class="form-input sm" id="settingSsdpTimeout" value="4" min="1" max="15" step="1">
                            <small>Wait time for UPnP device discovery</small>
                        </div>
                        <label class="toggle-row">
                            <input type="checkbox" id="settingDeepHttp" checked>
                            <span class="toggle-switch"></span>
                            HTTP/HTTPS probing
                        </label>
                        <label class="toggle-row">
                            <input type="checkbox" id="settingDeepSsl" checked>
                            <span class="toggle-switch"></span>
                            SSL/TLS certificate analysis
                        </label>
                        <label class="toggle-row">
                            <input type="checkbox" id="settingDeepBanners" checked>
                            <span class="toggle-switch"></span>
                            TCP banner grabbing
                        </label>
                        <label class="toggle-row">
                            <input type="checkbox" id="settingDeepSsdp" checked>
                            <span class="toggle-switch"></span>
                            SSDP / UPnP discovery
                        </label>
                        <label class="toggle-row">
                            <input type="checkbox" id="settingDeepMacVendor" checked>
                            <span class="toggle-switch"></span>
                            MAC vendor lookup (OUI)
                        </label>
                    </div>

                    <!-- Extended Discovery -->
                    <div class="settings-section">
                        <h6 class="settings-heading"><i class="fas fa-satellite mr-2"></i>Extended Discovery</h6>
                        <small class="text-muted d-block mb-2">Additional fingerprinting and info gathering probes.</small>
                        <label class="toggle-row">
                            <input type="checkbox" id="settingDeepSsh" checked>
                            <span class="toggle-switch"></span>
                            SSH host key fingerprint
                        </label>
                        <label class="toggle-row">
                            <input type="checkbox" id="settingDeepMdns" checked>
                            <span class="toggle-switch"></span>
                            mDNS / Bonjour discovery
                        </label>
                        <label class="toggle-row">
                            <input type="checkbox" id="settingDeepGeo" checked>
                            <span class="toggle-switch"></span>
                            Geolocation (public IPs)
                        </label>
                    </div>

                    <!-- Display -->
                    <div class="settings-section">
                        <h6 class="settings-heading"><i class="fas fa-palette mr-2"></i>Display</h6>
                        <label class="toggle-row">
                            <input type="checkbox" id="settingAutoScroll" checked>
                            <span class="toggle-switch"></span>
                            Auto-scroll to new results
                        </label>
                        <label class="toggle-row">
                            <input type="checkbox" id="settingShowOffline" checked>
                            <span class="toggle-switch"></span>
                            Show offline hosts in grid
                        </label>
                        <label class="toggle-row">
                            <input type="checkbox" id="settingAnimations" checked>
                            <span class="toggle-switch"></span>
                            Enable animations
                        </label>
                    </div>

                    <!-- Notifications -->
                    <div class="settings-section">
                        <h6 class="settings-heading"><i class="fas fa-bell mr-2"></i>Notifications</h6>
                        <label class="toggle-row">
                            <input type="checkbox" id="settingToasts" checked>
                            <span class="toggle-switch"></span>
                            Show toast notifications
                        </label>
                        <label class="toggle-row">
                            <input type="checkbox" id="settingSounds">
                            <span class="toggle-switch"></span>
                            Sound on scan complete
                        </label>
                    </div>

                    <!-- Live Update -->
                    <div class="settings-section">
                        <h6 class="settings-heading"><i class="fas fa-sync-alt mr-2"></i>Live Update</h6>
                        <div class="setting-row">
                            <label for="settingLiveInterval">Update Interval</label>
                            <select class="form-input sm" id="settingLiveInterval">
                                <option value="30">30 seconds</option>
                                <option value="60" selected>1 minute</option>
                                <option value="120">2 minutes</option>
                                <option value="300">5 minutes</option>
                                <option value="600">10 minutes</option>
                            </select>
                            <small>Wait time between ping rounds</small>
                        </div>
                        <div class="setting-row">
                            <label for="settingLivePingCount">Pings per Host</label>
                            <input type="number" class="form-input sm" id="settingLivePingCount" value="2" min="1" max="5" step="1">
                            <small>More pings = more reliable status</small>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-ghost" id="btnResetSettings">
                        <i class="fas fa-undo mr-1"></i>Reset
                    </button>
                    <button type="button" class="btn btn-primary-custom" data-dismiss="modal">
                        <i class="fas fa-check mr-1"></i>Done
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ── Scripts ─────────────────────────────────────────────────────── -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap4.min.js"></script>
    <script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>

    <script>
        // Fullscreen toggle
        document.getElementById('btnFullscreen').addEventListener('click', function () {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        });
    </script>

    {% block extra_js %}{% endblock %}
</body>
</html>
